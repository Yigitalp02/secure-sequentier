@{
    ViewData["Title"] = "Signature Certificate";
    var runId = ViewBag.RunId as string ?? "N/A";
    var user = ViewBag.User as string ?? "Unknown";
    var certData = ViewBag.CertData as string;
    var certApp = ViewBag.CertApp as string ?? "signer";
}

<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="text-center mb-4 d-print-none">
                <h2><i class="bi bi-award me-2 text-primary"></i>Signature Certificate</h2>
                <p class="text-muted">Print this page or save as PDF for a formal record of the digital signature.</p>
                <button class="btn btn-outline-primary" onclick="window.print()">
                    <i class="bi bi-printer me-1"></i> Print / Save as PDF
                </button>
            </div>

            <div class="certificate shadow" id="certificateContent">
                <div class="text-center mb-4">
                    <div class="certificate-seal">
                        <i class="bi bi-shield-lock-fill"></i>
                    </div>
                    <h2 class="mt-2" style="font-variant: small-caps; letter-spacing: 2px;">
                        Certificate of Digital Signature
                    </h2>
                    <hr />
                </div>

                <p class="text-center mb-4" style="font-size: 1.1rem;">
                    This certifies that the following file(s) have been digitally signed
                    using the <strong>Secure Sequentier</strong> platform.
                </p>

                <table class="table table-borderless" style="color: #333;">
                    <tr>
                        <td class="fw-bold" style="width: 160px;">Batch ID:</td>
                        <td class="font-monospace">@runId</td>
                    </tr>
                    <tr>
                        <td class="fw-bold">User Session:</td>
                        <td>@user</td>
                    </tr>
                    <tr>
                        <td class="fw-bold">Signer App:</td>
                        <td>@certApp</td>
                    </tr>
                    <tr>
                        <td class="fw-bold">Date Issued:</td>
                        <td>@DateTime.UtcNow.ToString("yyyy-MM-dd HH:mm:ss") UTC</td>
                    </tr>
                </table>

                @if (!string.IsNullOrEmpty(certData))
                {
                    <hr />
                    <h5 class="mb-3"><i class="bi bi-file-earmark-code me-2"></i>Signature Details</h5>
                    <pre class="bg-light p-3 rounded" style="font-size: 0.8rem; max-height: 300px; overflow: auto; color: #333;">@certData</pre>
                }

                <hr />
                <div class="text-center mt-4">
                    <p class="small text-muted mb-1">
                        <i class="bi bi-info-circle me-1"></i>
                        This certificate was generated by Secure Sequentier.
                        Verify file integrity using the Verify tool at
                        <strong>secure.ybilgin.com</strong>.
                    </p>
                    <p class="small text-muted mb-0">
                        <strong>&copy; @DateTime.Now.Year YiÄŸit Alp Bilgin</strong>
                    </p>
                </div>
            </div>

            <div class="text-center mt-4 d-print-none">
                <a asp-action="Queue" asp-route-runId="@runId" class="btn btn-outline-secondary">
                    <i class="bi bi-arrow-left me-1"></i> Back to Batch
                </a>
            </div>
        </div>
    </div>
</div>

@section Styles {
    <style>
        @@media print {
            header, footer, .d-print-none { display: none !important; }
            .certificate { border-width: 2px !important; box-shadow: none !important; }
            body { background: white !important; }
        }
    </style>
}

